<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>metID version0.2.1 • metID</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="metID version0.2.1">
<meta property="og:description" content="">
<meta property="og:image" content="https://jaspershen.github.io/metID/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metID</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Under development">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Category A</li>
    <li>
      <a href="../articles/metID.html">Instruction of metID</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Category B</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2018/12/readxl-1-2-0/">Test</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="../articles/metID.html">Version 0.0.1</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Links
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://snyderlab.stanford.edu/">Snyder lab</a>
    </li>
    <li>
      <a href="https://www.shenxt.info/">Shen blog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/contact_us.html">Contact us</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/metID.html">Get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaspershen/metID">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/JasperShen1990">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>metID version0.2.1</h1>
                        <h4 class="author">Xiaotao Shen (<a href="https://www.shenxt.info/" class="uri">https://www.shenxt.info/</a>)</h4>
                                    <h4 class="author">Si Wu</h4>
            <address class="author_afil">
      School of Medicine, Stanford University<br><h4 class="date">2020-01-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jaspershen/metID/blob/master/vignettes/metID.Rmd"><code>vignettes/metID.Rmd</code></a></small>
      <div class="hidden name"><code>metID.Rmd</code></div>

    </address>
</div>

    
    
<div id="introduction-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-installation" class="anchor"></a><strong>Introduction &amp; Installation</strong>
</h2>
<hr>
<p><em>metID</em> is a R package which can be used for database construction, and metabolite identification based on in-house and public database.</p>
<p><img src="../man/figures/workflow_metid.jpg"></p>
<p>Please install it via <a href="https://github.com/jaspershen/metID">github</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(devtools)){</a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">}</a>
<a class="sourceLine" id="cb1-4" title="4">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"jaspershen/metID"</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">##tinyTools is a dependent package for metID</span></a>
<a class="sourceLine" id="cb1-6" title="6">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"jaspershen/tinyTools"</span>)</a></code></pre></div>
</div>
<div id="database-construction" class="section level2">
<h2 class="hasAnchor">
<a href="#database-construction" class="anchor"></a><strong>Database construction</strong>
</h2>
<hr>
<p>If you have in-house standards which have been acquired with MS2 spectra data, then you can construct the in-house MS2 spectra databases using <code>metID</code> package.</p>
<div id="data-preparation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a><strong>Data preparation</strong>
</h3>
<p>Firstly, please transform your raw standard MS data (positive and negative modes) to mzXML format using <a href="http://proteowizard.sourceforge.net/">ProteoWizard</a>. The parameter setting is shown like figure below:</p>
<p><img src="../man/figures/parameter_setting_MS_conventer.png"></p>
</div>
<div id="data-organization" class="section level3">
<h3 class="hasAnchor">
<a href="#data-organization" class="anchor"></a><strong>Data organization</strong>
</h3>
<p>Secondly, please organize your standard information as a table, and output as a csv or xlsx format. The format of stanford information can refer to our demo data in <code>demoData</code> package.</p>
<p>From column 1 to 11, the columns are “Lab.ID”, “mz”, “RT”, “CAS.ID”, “HMDB.ID”, “KEGG.ID”, “Formula”, “mz.pos”, “mz.neg”, “Submitter”, respectively. It is OK if you have another information for the standards. Like the demo data shows, there are other additional information, namely “Family”, “Sub.pathway” and “Note”.</p>
<ul>
<li><p>mz: Accurate mass of compound.</p></li>
<li><p>RT: Retention time, unit is second.</p></li>
<li><p>mz.pos: Mass to change ratio of compound in positive mode, for example, M+H.</p></li>
<li><p>mz.neg: Mass to change ratio of compound in negative mode, for example, M-H.</p></li>
<li><p>Submitter: The name of person or organization.</p></li>
</ul>
<p><img src="../man/figures/compound_information.PNG"></p>
<p>Then creat a folder and put you mzXML format datasets (positive mode in ‘POS’ folder and negative mode in ‘NEG’ folder) and compound information in it.</p>
<p><img src="../man/figures/database_construction.png"></p>
</div>
<div id="run-databaseconstruction-function" class="section level3">
<h3 class="hasAnchor">
<a href="#run-databaseconstruction-function" class="anchor"></a><strong>Run <code>databaseConstruction</code> function</strong>
</h3>
<p>We use the demo data in <code>demoData</code> package to show how to use <code>metID</code>. Please install it first.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"jaspershen/demoData"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(demoData)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metID)</a>
<a class="sourceLine" id="cb3-3" title="3">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"database_construction"</span>, <span class="dt">package =</span> <span class="st">"demoData"</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> path, <span class="dt">to =</span> <span class="st">"."</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-5" title="5">new.path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"./database_construction"</span>)</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7">test.database &lt;-<span class="st"> </span><span class="kw"><a href="../reference/databaseConstruction.html">databaseConstruction</a></span>(<span class="dt">path =</span> new.path, </a>
<a class="sourceLine" id="cb3-8" title="8">                                      <span class="dt">version =</span> <span class="st">"0.0.1"</span>,</a>
<a class="sourceLine" id="cb3-9" title="9">                                      <span class="dt">metabolite.info.name =</span> <span class="st">"metabolite.info_RPLC.csv"</span>, </a>
<a class="sourceLine" id="cb3-10" title="10">                                      <span class="dt">source =</span> <span class="st">"Michael Snyder lab"</span>, </a>
<a class="sourceLine" id="cb3-11" title="11">                                      <span class="dt">link =</span> <span class="st">"http://snyderlab.stanford.edu/"</span>,</a>
<a class="sourceLine" id="cb3-12" title="12">                                      <span class="dt">creater =</span> <span class="st">"Xiaotao Shen"</span>,</a>
<a class="sourceLine" id="cb3-13" title="13">                                      <span class="dt">email =</span> <span class="st">"shenxt1990@163.com"</span>,</a>
<a class="sourceLine" id="cb3-14" title="14">                                      <span class="dt">rt =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-15" title="15">                                      <span class="dt">mz.tol =</span> <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb3-16" title="16">                                      <span class="dt">rt.tol =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb3-17" title="17">                                      <span class="dt">threads =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>The arguments of <code>databaseConstruction</code> can be found using <code><a href="../reference/databaseConstruction.html">?databaseConstruction</a></code>.</p>
<p>test.database is a <code>databaseClass</code> object, you can print it to see its information.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">test.database</a></code></pre></div>
<blockquote>
<p>Note: <code>test.database</code> is only a demo database (metIdentifyClass). We will don’t use it for next metabolite identification.</p>
</blockquote>
</div>
</div>
<div id="retention-time-correction" class="section level2">
<h2 class="hasAnchor">
<a href="#retention-time-correction" class="anchor"></a><strong>Retention time correction</strong>
</h2>
<hr>
<p>The metabolite retention time (RT) may shift in different batches. So if you spike internal standards into your standards and biological samples, you can correct the RTs in database using <code>rtCor4database</code> function.</p>
<div id="data-preparation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-1" class="anchor"></a><strong>Data preparation</strong>
</h3>
<p>Firstly, please prepare two internal standard (IS) tables for database and biological samples. The format of IS table is shown like figure below:</p>
<p><img src="../man/figures/IS_table.png"></p>
<p>The IS table for database should be named as “database.is.table.xlsx” and the IS table for experiment should be named as “experiment.is.table.xlsx”.</p>
</div>
<div id="run-rtcor4database-function" class="section level3">
<h3 class="hasAnchor">
<a href="#run-rtcor4database-function" class="anchor"></a><strong>Run <code>rtCor4database</code> function</strong>
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">test.database2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rtCor4database.html">rtCor4database</a></span>(<span class="dt">experiment.is.table =</span> <span class="st">"experiment.is.table.xlsx"</span>, </a>
<a class="sourceLine" id="cb5-2" title="2">                                 <span class="dt">database.is.table =</span> <span class="st">"database.is.table.xlsx"</span>, </a>
<a class="sourceLine" id="cb5-3" title="3">                                 <span class="dt">database =</span> test.database, </a>
<a class="sourceLine" id="cb5-4" title="4">                                 <span class="dt">path =</span> new.path)</a></code></pre></div>
<p>The <code>database</code> should be the database (databaseClass object) which you want to correct RTs.</p>
<blockquote>
<p>Note: <code>test.database2</code> is only a demo database (metIdentifyClass). We will don’t use it for next metabolite identification.</p>
</blockquote>
</div>
</div>
<div id="metabolite-identification" class="section level2">
<h2 class="hasAnchor">
<a href="#metabolite-identification" class="anchor"></a><strong>Metabolite identification</strong>
</h2>
<hr>
<div id="identify-metabolites-based-on-ms2-library" class="section level3">
<h3 class="hasAnchor">
<a href="#identify-metabolites-based-on-ms2-library" class="anchor"></a><strong>Identify metabolites based on MS2 library</strong>
</h3>
<div id="ms1-data-preparation" class="section level4">
<h4 class="hasAnchor">
<a href="#ms1-data-preparation" class="anchor"></a>MS1 data preparation</h4>
<p>The peak table must contain “name” (peak name), “mz” (mass to charge ratio) and “rt” (retention time, unit is second). It can be from any data processing software (XCMS, MS-DIAL and so on).</p>
</div>
<div id="ms2-data-preparation" class="section level4">
<h4 class="hasAnchor">
<a href="#ms2-data-preparation" class="anchor"></a>MS2 data preparation</h4>
<p>The raw MS2 data from DDA or DIA should be transfered to msp, mgf or mzXML format files. You can use <a href="http://proteowizard.sourceforge.net/">ProteoWizard</a> software.</p>
</div>
<div id="data-organization-1" class="section level4">
<h4 class="hasAnchor">
<a href="#data-organization-1" class="anchor"></a>Data organization</h4>
<p>Place the MS1 peak table, MS2 data and database which you want to use in one folder like below figure shows:</p>
<p><img src="../man/figures/metabolite_identification.png"></p>
</div>
<div id="run-metidentify-function" class="section level4">
<h4 class="hasAnchor">
<a href="#run-metidentify-function" class="anchor"></a>Run <code>metIdentify</code> function</h4>
<p>We can use the demo data from <code>demoData</code> package to show how to use it.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metID)</a>
<a class="sourceLine" id="cb6-2" title="2">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"ms2_identification_demo_data1"</span>, <span class="dt">package =</span> <span class="st">"demoData"</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> path, <span class="dt">to =</span> <span class="st">"."</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-4" title="4">new.path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"./ms2_identification_demo_data1"</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"msDatabase_rplc0.0.1"</span>, <span class="dt">package =</span> <span class="st">"metID"</span>)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(msDatabase_rplc0.<span class="fl">0.1</span>, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(new.path, <span class="st">"msDatabase_rplc0.0.1"</span>))</a>
<a class="sourceLine" id="cb6-8" title="8">ms2.data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="dt">pattern =</span> <span class="st">"mgf"</span>, <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(new.path), <span class="dt">value =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"></a>
<a class="sourceLine" id="cb6-10" title="10">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metIdentify.html">metIdentify</a></span>(<span class="dt">ms1.data =</span> <span class="st">"ms1.peak.table.csv"</span>, <span class="co">##csv format</span></a>
<a class="sourceLine" id="cb6-11" title="11">           <span class="dt">ms2.data =</span> ms2.data,<span class="co">##only msp and mgf and mz(X)ML are supported</span></a>
<a class="sourceLine" id="cb6-12" title="12">           <span class="dt">ms1.ms2.match.mz.tol =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb6-13" title="13">           <span class="dt">ms1.ms2.match.rt.tol =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb6-14" title="14">           <span class="dt">ms1.match.ppm =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb6-15" title="15">           <span class="dt">ms2.match.tol =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb6-16" title="16">           <span class="dt">fraction.weight =</span> <span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb6-17" title="17">           <span class="dt">dp.forward.weight =</span> <span class="fl">0.6</span>,</a>
<a class="sourceLine" id="cb6-18" title="18">           <span class="dt">dp.reverse.weight =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb6-19" title="19">           <span class="dt">rt.match.tol =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb6-20" title="20">           <span class="dt">polarity =</span> <span class="st">"positive"</span>, </a>
<a class="sourceLine" id="cb6-21" title="21">           <span class="dt">ce =</span> <span class="st">"all"</span>,</a>
<a class="sourceLine" id="cb6-22" title="22">           <span class="dt">column =</span> <span class="st">"rp"</span>,</a>
<a class="sourceLine" id="cb6-23" title="23">           <span class="dt">ms1.match.weight =</span> <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb6-24" title="24">           <span class="dt">rt.match.weight =</span> <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb6-25" title="25">           <span class="dt">ms2.match.weight =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb6-26" title="26">           <span class="dt">path =</span> new.path,</a>
<a class="sourceLine" id="cb6-27" title="27">           <span class="dt">total.score.tol =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb6-28" title="28">           <span class="dt">candidate.num =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb6-29" title="29">           <span class="dt">database =</span> <span class="st">"msDatabase_rplc0.0.1"</span>,</a>
<a class="sourceLine" id="cb6-30" title="30">           <span class="dt">threads =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>The argument of <code>metIdentify</code> can be found using <code><a href="../reference/metIdentify.html">?metIdentify</a></code>.</p>
<ul>
<li><p>ms1.data: The MS1 peak table name. It must be the “csv” format.</p></li>
<li><p>ms2.data: The MS2 data name. It can be msp, mgf or mzXML format.</p></li>
<li><p>ms1.ms2.match.mz.tol: The m/z tolerance for MS1 peak and MS2 spectrum match. Default is 25 ppm.</p></li>
<li><p>ms1.ms2.match.rt.tol: The RT tolerance for MS1 peak and MS2 spectrum match. Default is 10 s.</p></li>
<li><p>ms1.match.ppm: The m/z tolerance for peak and database metabolite match.</p></li>
<li><p>ms2.match.tol: The MS2 similarity tolerance for peak and database metabolite match. The MS2 similarity refers to the algorithm from <a href="https://www.nature.com/articles/nmeth.3393">MS-DIAl</a>. So if you want to know more information about it, please read this publication.</p></li>
</ul>
<p><span class="math display">\[MS2\;Simlarity\;Score\;(SS) = Fragment\;fraction*Weight_{fraction} + Dot\;product(forward) * Weight_{dp.reverse}+Dot\;product(reverse)*Weight_{dp.reverse}\]</span></p>
<ul>
<li>fraction.weight: The weight for fragment match fraction.</li>
</ul>
<p><span class="math display">\[Fragment\;match\;fraction = \dfrac{Match\;fragement\;number}{All\;fragment\;number}\]</span></p>
<!-- ![](../man/figures/fragment_match_fraction.PNG) -->
<ul>
<li><p>dp.forward.weight: The weight for dot product (forward)</p></li>
<li><p>dp.forward.weight: The weight for dot product (forward)</p></li>
</ul>
<p><span class="math display">\[Dot\;product = \dfrac{\sum(wA_{act.}wA_{lib})^2}{\sum(wA_{act.})^2\sum(wA_{lib})^2}with\;w =1/(1+\dfrac{A}{\sum(A-0.5)})\]</span></p>
<!-- ![](../man/figures/DP.PNG) -->
<p><code>result</code> is metIdentifyClass object. You can print it out to see the identificaiton information.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">result</a></code></pre></div>
<blockquote>
<p>In-house database The in-house database in our lab were provided, with RPLC and HILIC mode RT information. They were acquired using Thermo Fisher QE-plus. However, the LC system may be different with your experiments, so if you want to use our in-house database for metabolite identification, please set <code>rt.match.tol</code> as 100000000(no limitation). The in-house database can be downloaded in my <a href="https://github.com/jaspershen/metID/tree/master/data">github</a>.</p>
</blockquote>
<p>You can get processsing parameters from it.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">parameters &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getParams.html">getParams</a></span>(<span class="dt">object =</span> result)</a>
<a class="sourceLine" id="cb8-2" title="2">tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as.tibble</a></span>(parameters)</a></code></pre></div>
<p>You can also get the identification table from it.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">identification.table1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getIdentificationTable.html">getIdentificationTable</a></span>(<span class="dt">object =</span> result)</a></code></pre></div>
</div>
</div>
<div id="filter" class="section level3">
<h3 class="hasAnchor">
<a href="#filter" class="anchor"></a><strong>Filter</strong>
</h3>
<p>You can use <code>filterIden</code> function to filer identification results from the <code>metIdentifyClass</code> object according to m/z error, rt error, MS2 spectra similarity and total score.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">result.new &lt;-<span class="st"> </span><span class="kw"><a href="../reference/filterIden.html">filterIden</a></span>(<span class="dt">object =</span> result, <span class="dt">ms1.match.ppm =</span> <span class="dv">10</span>)</a></code></pre></div>
</div>
<div id="ms2-spectra-match-plot-output" class="section level3">
<h3 class="hasAnchor">
<a href="#ms2-spectra-match-plot-output" class="anchor"></a><strong>MS2 spectra match plot output</strong>
</h3>
<p>You can also use <code>ms2plot</code> function to output the MS2 specra match plot for one, multiple or all peaks.</p>
<blockquote>
<p>Output one MS2 spectra match plot.</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">##which peaks have identification</span></a>
<a class="sourceLine" id="cb11-2" title="2">peak.name &lt;-<span class="st"> </span><span class="kw"><a href="../reference/whichHasIden.html">whichHasIden</a></span>(<span class="dt">object =</span> result)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(peak.name)</a>
<a class="sourceLine" id="cb11-4" title="4">ms2.plot1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ms2plot.html">ms2plot</a></span>(<span class="dt">object =</span> result, <span class="dt">database =</span> msDatabase_rplc0.<span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb11-5" title="5">                     <span class="dt">which.peak =</span> peak.name[<span class="dv">1</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb11-6" title="6">ms2.plot1</a></code></pre></div>
<blockquote>
<p>You can also output interactive MS2 spectra match plot by setting <code>interaction.plot</code> as TRUE.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">##which peaks have identification</span></a>
<a class="sourceLine" id="cb12-2" title="2">ms2.plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ms2plot.html">ms2plot</a></span>(<span class="dt">object =</span> result, <span class="dt">database =</span> msDatabase_rplc0.<span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb12-3" title="3">                     <span class="dt">which.peak =</span> peak.name[<span class="dv">1</span>,<span class="dv">1</span>], <span class="dt">interaction.plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">ms2.plot2</a></code></pre></div>
<blockquote>
<p>You can output all MS2 spectra match plots by setting <code>which.peak</code> as “all”.</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/ms2plot.html">ms2plot</a></span>(<span class="dt">object =</span> result, <span class="dt">database =</span> msDatabase_rplc0.<span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb13-2" title="2">                     <span class="dt">which.peak =</span> <span class="st">"all"</span>, <span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(new.path, <span class="st">"inhouse"</span>))</a></code></pre></div>
<p>Then all the MS2 spectra match plots will be output in the “inhouse” folder.</p>
</div>
</div>
<div id="result-integration-and-output" class="section level2">
<h2 class="hasAnchor">
<a href="#result-integration-and-output" class="anchor"></a><strong>Result integration and output</strong>
</h2>
<hr>
<p>You can also use other public database for metabolite identificaiton based on MS2 spectra. We provided four public database, which can be got from the <a href="https://github.com/jaspershen/demoData/tree/master/inst/ms2_database"><code>demoData</code> package</a>.</p>
<ul>
<li><p>MassBank database (massbankDatabase0.0.1)</p></li>
<li><p>MoNA database (monaDatabase0.0.1)</p></li>
<li><p>HMDB database (hmdbDatabase0.0.1)</p></li>
<li><p>Orbitrap database from MassBank (orbitrapDatabase0.0.1)</p></li>
</ul>
<p>Here, we will use orbitrap database and HMDB database for metabolite identification. The <code>metIdentify4all</code> function can identify metabolites with several databases.</p>
<div id="prepare-demo-data" class="section level3">
<h3 class="hasAnchor">
<a href="#prepare-demo-data" class="anchor"></a>Prepare demo data</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(demoData)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metID)</a>
<a class="sourceLine" id="cb14-3" title="3">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"ms2_database"</span>, <span class="dt">package =</span> <span class="st">"demoData"</span>)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(path, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"orbitrapDatabase0.0.1"</span>, <span class="st">"hmdbDatabase0.0.1"</span>)), </a>
<a class="sourceLine" id="cb14-5" title="5">          <span class="dt">to =</span> new.path, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(new.path, <span class="st">"orbitrapDatabase0.0.1"</span>))</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(new.path, <span class="st">"hmdbDatabase0.0.1"</span>))</a></code></pre></div>
</div>
<div id="prepare-parameter-list-for-each-database" class="section level3">
<h3 class="hasAnchor">
<a href="#prepare-parameter-list-for-each-database" class="anchor"></a>Prepare parameter list for each database</h3>
<p>We can use <code>metIdentifyParam</code> and <code>mzIdentifyParam</code> to get parameter list for different databases.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">parameter.list1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metIdentifyParam.html">metIdentifyParam</a></span>(<span class="dt">polarity =</span> <span class="st">"positive"</span>, </a>
<a class="sourceLine" id="cb15-2" title="2">                                    <span class="dt">candidate.num =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb15-3" title="3">                                    <span class="dt">column =</span> <span class="st">"rp"</span>, <span class="dt">ce =</span> <span class="st">"all"</span>, </a>
<a class="sourceLine" id="cb15-4" title="4">                                    <span class="dt">database =</span> <span class="st">"orbitrapDatabase0.0.1"</span>, </a>
<a class="sourceLine" id="cb15-5" title="5">                                    <span class="dt">threads =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-6" title="6"></a>
<a class="sourceLine" id="cb15-7" title="7">parameter.list2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metIdentifyParam.html">metIdentifyParam</a></span>(<span class="dt">polarity =</span> <span class="st">"positive"</span>, </a>
<a class="sourceLine" id="cb15-8" title="8">                                    <span class="dt">candidate.num =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb15-9" title="9">                                    <span class="dt">column =</span> <span class="st">"rp"</span>, <span class="dt">ce =</span> <span class="st">"all"</span>, </a>
<a class="sourceLine" id="cb15-10" title="10">                                    <span class="dt">database =</span> <span class="st">"hmdbDatabase0.0.1"</span>, </a>
<a class="sourceLine" id="cb15-11" title="11">                                    <span class="dt">threads =</span> <span class="dv">3</span>)</a></code></pre></div>
</div>
<div id="run-metidentify4all-function" class="section level3">
<h3 class="hasAnchor">
<a href="#run-metidentify4all-function" class="anchor"></a>Run <code>metIdentify4all</code> function</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">result2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metIdentify4all.html">metIdentify4all</a></span>(<span class="dt">ms1.data =</span> <span class="st">"ms1.peak.table.csv"</span>, <span class="co">##csv format  </span></a>
<a class="sourceLine" id="cb16-2" title="2">                           <span class="dt">ms2.data =</span> ms2.data, <span class="dt">parameter.list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(parameter.list1, parameter.list2), </a>
<a class="sourceLine" id="cb16-3" title="3">                           <span class="dt">path =</span> new.path)</a></code></pre></div>
<p>It will return a list of objects of identification results.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">result2[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb17-2" title="2">result2[[<span class="dv">2</span>]]</a></code></pre></div>
<p>We can also identify metabolites only m/z match, which is level 3 identification according to MSI. We provid the HMDB metabolite database in the <a href="https://github.com/jaspershen/demoData/tree/master/inst/hmdb_metabolite_database"><code>demoData</code> package</a>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(demoData)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metID)</a>
<a class="sourceLine" id="cb18-3" title="3">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"hmdb_metabolite_database"</span>, <span class="dt">package =</span> <span class="st">"demoData"</span>)</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(path, <span class="st">"HMDB.metabolite.data"</span>), </a>
<a class="sourceLine" id="cb18-5" title="5">          <span class="dt">to =</span> new.path, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7">result3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mzIdentify.html">mzIdentify</a></span>(<span class="dt">ms1.data =</span> <span class="st">"ms1.peak.table.csv"</span>, <span class="co">##csv format </span></a>
<a class="sourceLine" id="cb18-8" title="8">           <span class="dt">ms1.match.ppm =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb18-9" title="9">           <span class="dt">polarity =</span> <span class="st">"positive"</span>, </a>
<a class="sourceLine" id="cb18-10" title="10">           <span class="dt">column =</span> <span class="st">"rp"</span>,</a>
<a class="sourceLine" id="cb18-11" title="11">           <span class="dt">path =</span> new.path,</a>
<a class="sourceLine" id="cb18-12" title="12">           <span class="dt">candidate.num =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb18-13" title="13">           <span class="dt">database =</span> <span class="st">"HMDB.metabolite.data"</span>,</a>
<a class="sourceLine" id="cb18-14" title="14">           <span class="dt">threads =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>For result1 using in-hosue database (m/z, RT and MS2 spectra), they are level 1 identifications. For result2 using public MS2 spectra database (m/z and MS2 spectra), they are level 2 identifications. For result3 using HMDB metabolite database (only m/z), they are level 3 identifications according to MSI. So you can integrate those three results together.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">identification.table1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getIdentificationTable.html">getIdentificationTable</a></span>(<span class="dt">object =</span> result, <span class="dt">candidate.num =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"new"</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">identification.table1 &lt;-<span class="st"> </span>identification.table1[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(identification.table1<span class="op">$</span>Compound.name),,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4">identification.table2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getIdentificationTable.html">getIdentificationTable</a></span>(<span class="dt">object =</span> result2, <span class="dt">candidate.num =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"new"</span>)</a>
<a class="sourceLine" id="cb19-5" title="5">identification.table2 &lt;-<span class="st"> </span>identification.table2[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(identification.table2<span class="op">$</span>Compound.name),,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb19-6" title="6">identification.table2 &lt;-<span class="st"> </span>identification.table2[<span class="op">!</span>(identification.table2<span class="op">$</span>name <span class="op">%in%</span><span class="st"> </span>identification.table1<span class="op">$</span>name),,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb19-7" title="7"></a>
<a class="sourceLine" id="cb19-8" title="8">identification.table3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getIdentificationTable2.html">getIdentificationTable2</a></span>(<span class="dt">object =</span> result3, <span class="dt">candidate.num =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">"new"</span>)</a>
<a class="sourceLine" id="cb19-9" title="9">identification.table3 &lt;-<span class="st"> </span>identification.table3[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(identification.table3<span class="op">$</span>Compound.name),,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb19-10" title="10">identification.table3 &lt;-<span class="st"> </span>identification.table3[<span class="op">!</span>(identification.table3<span class="op">$</span>name <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(identification.table1<span class="op">$</span>name,identification.table1<span class="op">$</span>name)),,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb19-11" title="11"></a>
<a class="sourceLine" id="cb19-12" title="12">identification.table1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(identification.table1, <span class="dt">Level =</span> <span class="dv">1</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-13" title="13">identification.table2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(identification.table2, <span class="dt">Level =</span> <span class="dv">2</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-14" title="14">identification.table3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(identification.table3[<span class="op">-</span><span class="dv">11</span>], </a>
<a class="sourceLine" id="cb19-15" title="15">                                    <span class="st">"mz.match.score"</span> =<span class="st"> </span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb19-16" title="16">                                    <span class="st">"RT.error"</span> =<span class="st"> </span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb19-17" title="17">                                    <span class="st">"RT.match.score"</span> =<span class="st"> </span><span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb19-18" title="18">                                    <span class="st">"CE"</span> =<span class="st"> </span><span class="ot">NA</span>,  </a>
<a class="sourceLine" id="cb19-19" title="19">                                    <span class="st">"SS"</span> =<span class="st"> </span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb19-20" title="20">                                    <span class="st">"Total.score"</span> =<span class="st"> </span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb19-21" title="21">                                    identification.table3[<span class="dv">11</span>],</a>
<a class="sourceLine" id="cb19-22" title="22">                                    <span class="dt">Level =</span> <span class="dv">3</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-23" title="23"></a>
<a class="sourceLine" id="cb19-24" title="24">identification.table &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(identification.table1, </a>
<a class="sourceLine" id="cb19-25" title="25">                              identification.table2, </a>
<a class="sourceLine" id="cb19-26" title="26">                              identification.table3)</a>
<a class="sourceLine" id="cb19-27" title="27"></a>
<a class="sourceLine" id="cb19-28" title="28"><span class="kw"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span>(identification.table, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(new.path, <span class="st">"identification.table.csv"</span>), <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<blockquote>
<p>Note: Of course, you can also use <code>metIdentify4all</code> function to run all the databases(in-house, publica database and HMDB metabolite database) in one run like we have shown above. What should be noticed is that the parameter list for HMDB.metabolite.data must use <code>mzIdentifyParam</code> function to construct.</p>
</blockquote>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-installation"><strong>Introduction &amp; Installation</strong></a></li>
      <li>
<a href="#database-construction"><strong>Database construction</strong></a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-preparation"><strong>Data preparation</strong></a></li>
      <li><a href="#data-organization"><strong>Data organization</strong></a></li>
      <li><a href="#run-databaseconstruction-function"><strong>Run <code>databaseConstruction</code> function</strong></a></li>
      </ul>
</li>
      <li>
<a href="#retention-time-correction"><strong>Retention time correction</strong></a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-preparation-1"><strong>Data preparation</strong></a></li>
      <li><a href="#run-rtcor4database-function"><strong>Run <code>rtCor4database</code> function</strong></a></li>
      </ul>
</li>
      <li>
<a href="#metabolite-identification"><strong>Metabolite identification</strong></a><ul class="nav nav-pills nav-stacked">
<li><a href="#identify-metabolites-based-on-ms2-library"><strong>Identify metabolites based on MS2 library</strong></a></li>
      <li><a href="#filter"><strong>Filter</strong></a></li>
      <li><a href="#ms2-spectra-match-plot-output"><strong>MS2 spectra match plot output</strong></a></li>
      </ul>
</li>
      <li>
<a href="#result-integration-and-output"><strong>Result integration and output</strong></a><ul class="nav nav-pills nav-stacked">
<li><a href="#prepare-demo-data">Prepare demo data</a></li>
      <li><a href="#prepare-parameter-list-for-each-database">Prepare parameter list for each database</a></li>
      <li><a href="#run-metidentify4all-function">Run <code>metIdentify4all</code> function</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xiaotao Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2f09495997a50f5008bc92fa73c5552d',
    indexName: 'metidentify',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
